<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlashMorCoin - Protocolo DeFi Automatizado</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white; font-family: 'Arial', sans-serif;
            min-height: 100vh;
        }
        
        .ancient-coin {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle at 30% 30%, #D4AF37, #B8860B, #8B4513);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 0 0 2px #8B4513,
                0 4px 15px rgba(139, 69, 19, 0.6),
                inset 0 1px 6px rgba(255, 215, 0, 0.4);
            border: 2px solid #CD7F32;
            position: relative;
            font-family: 'Times New Roman', serif;
        }

        .ancient-coin::before {
            content: "";
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle at 70% 70%, transparent 30%, rgba(0,0,0,0.2) 100%);
        }

        .coin-design {
            position: relative;
            z-index: 2;
            text-align: center;
            color: #8B4513;
            text-shadow: 1px 1px 2px rgba(255, 215, 0, 0.5);
        }

        .coin-symbol {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 1px;
        }

        .coin-text {
            font-size: 9px;
            font-weight: bold;
            letter-spacing: 0.5px;
        }

        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        
        header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px 30px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .brand-text {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .connect-btn {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .connect-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .card { 
            background: rgba(255,255,255,0.1); 
            backdrop-filter: blur(10px);
            padding: 25px; 
            border-radius: 15px; 
            margin: 20px 0; 
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .action-btn { 
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #8B4513; 
            border: none; 
            padding: 12px 20px; 
            border-radius: 8px; 
            cursor: pointer; 
            margin: 5px; 
            font-weight: bold; 
            transition: all 0.3s;
            width: 100%;
        }
        
        .action-btn:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
        }
        
        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; 
        }
        
        input, select { 
            width: 100%; 
            padding: 12px; 
            margin: 8px 0; 
            border: none; 
            border-radius: 8px; 
            background: rgba(255,255,255,0.9);
            color: #333;
        }
        
        .loading { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.8); 
            z-index: 1000; 
            justify-content: center; 
            align-items: center; 
        }
        
        .success { 
            background: rgba(76, 175, 80, 0.3); 
            border: 1px solid #4CAF50; 
            padding: 15px; 
            border-radius: 8px; 
            margin: 10px 0; 
        }
        
        .error { 
            background: rgba(244, 67, 54, 0.3); 
            border: 1px solid #f44336; 
            padding: 15px; 
            border-radius: 8px; 
            margin: 10px 0; 
        }
        
        .wallet-info {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.3);
            text-align: center;
        }
        
        .status-badge { 
            padding: 4px 8px; 
            border-radius: 12px; 
            font-size: 12px; 
            margin-left: 10px; 
        }
        
        .status-active { 
            background: #4CAF50; 
        }
        
        .status-inactive { 
            background: #f44336; 
        }
        
        .network-info {
            background: rgba(255,255,255,0.1);
            padding: 10px 15px;
            border-radius: 8px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .network-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .network-connected { background: #4CAF50; }
        .network-disconnected { background: #f44336; }
        
        .transaction-status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            border-left: 4px solid #FFD700;
        }
        
        .progress-bar {
            height: 6px;
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #FFD700, #FFA500);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .auto-connect-notice {
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid #FFD700;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .stat-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        .auto-refresh-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(76, 175, 80, 0.9);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            z-index: 1001;
        }
        
        .network-badge {
            background: rgba(255,255,255,0.2);
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            margin-left: 10px;
        }
        
        .bsc-badge {
            background: linear-gradient(45deg, #F0B90B, #F8D33A);
            color: #000;
        }
        
        .polygon-badge {
            background: linear-gradient(45deg, #8247E5, #A16BF0);
        }
    </style>
</head>
<body>
    <div class="loading" id="loading">
        <div style="background: white; color: #333; padding: 30px; border-radius: 15px; text-align: center; min-width: 300px;">
            <div style="font-size: 2rem; margin-bottom: 10px;">‚è≥</div>
            <p id="loading-text">Conectando autom√°ticamente...</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>
    </div>

    <div id="auto-refresh-indicator" class="auto-refresh-indicator" style="display: none;">
        üîÑ Actualizando autom√°ticamente...
    </div>

    <div class="container">
        <header>
            <div class="logo-container">
                <div class="ancient-coin">
                    <div class="coin-design">
                        <div class="coin-symbol">‚ö°</div>
                        <div class="coin-text">FMC</div>
                    </div>
                </div>
                <div class="brand-text">FlashMorCoin</div>
                <div id="network-badge" class="network-badge" style="display: none;"></div>
            </div>
            
            <div id="wallet-section">
                <button class="connect-btn" onclick="connectWallet()" id="connect-btn">
                    üîó Conectar MetaMask
                </button>
                <div class="wallet-info" id="wallet-info" style="display: none;">
                    <div><strong>‚úÖ Wallet Conectada:</strong> <span id="wallet-address">0x3D114033Ed4C0BeAf9F554A5c84d7C5ca5b04765</span></div>
                    <div><strong>üí∞ Balance:</strong> <span id="wallet-balance">-</span> <span id="native-currency">ETH</span></div>
                    <div class="network-info">
                        <span class="network-dot network-connected" id="network-status"></span>
                        <span id="network-name">Conectando...</span>
                    </div>
                    <button onclick="disconnectWallet()" style="background: #ff4444; color: white; padding: 5px 10px; margin-top: 8px; font-size: 12px;">
                        üö™ Desconectar
                    </button>
                </div>
            </div>
        </header>

        <div class="card" id="welcome-section">
            <h2>üöÄ FlashMorCoin - Modo 100% Autom√°tico</h2>
            <p>Protocolo DeFi completamente automatizado con tu wallet personal</p>
            
            <div class="auto-connect-notice" id="auto-connect-notice">
                <p>ü§ñ <strong>MODO AUTOM√ÅTICO ACTIVADO</strong></p>
                <p>Wallet detectada: 0x3D114033Ed4C0BeAf9F554A5c84d7C5ca5b04765</p>
                <p>Conectando autom√°ticamente...</p>
            </div>
            
            <div class="grid" style="margin-top: 20px;">
                <div>
                    <h3>üéØ Sistema Autom√°tico Activo:</h3>
                    <p>‚Ä¢ ‚úÖ <strong>Wallet integrada</strong> autom√°ticamente</p>
                    <p>‚Ä¢ üîÑ <strong>Detecci√≥n inteligente</strong> de red</p>
                    <p>‚Ä¢ üí∞ <strong>Balance en tiempo real</strong></p>
                    <p>‚Ä¢ ü§ñ <strong>Transacciones automatizadas</strong></p>
                    <p>‚Ä¢ üìä <strong>An√°lisis autom√°tico</strong> de mercado</p>
                </div>
                <div>
                    <h3>üîß Configuraci√≥n Autom√°tica:</h3>
                    <p>‚Ä¢ üè∑Ô∏è <strong>Wallet:</strong> 0x3D1140...b04765</p>
                    <p>‚Ä¢ üåê <strong>Red:</strong> Detecci√≥n autom√°tica</p>
                    <p>‚Ä¢ üí∏ <strong>Tokens:</strong> Auto-adaptaci√≥n BSC/Polygon</p>
                    <p>‚Ä¢ ‚ö° <strong>Velocidad:</strong> Transacciones optimizadas</p>
                    <div style="margin-top: 15px;">
                        <button onclick="showAdvancedSettings()" style="background: #4ECDC4; color: white; padding: 10px 15px; border: none; border-radius: 8px;">
                            ‚öôÔ∏è Configuraci√≥n Avanzada
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Portfolio Autom√°tico -->
        <div class="card" id="portfolio-section" style="display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2>üìä Portfolio Autom√°tico</h2>
                <div style="font-size: 0.8rem; opacity: 0.7;">
                    üîÑ Actualizado: <span id="last-update">-</span>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Balance Principal</div>
                    <div class="stat-value" id="native-balance">-</div>
                    <div class="stat-label" id="native-currency-2">ETH</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Tokens FMC</div>
                    <div class="stat-value" id="fmc-balance">0.00</div>
                    <div class="stat-label">FMC</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Colateral</div>
                    <div class="stat-value" id="vault-balance">0.00</div>
                    <div class="stat-label" id="stablecoin">USDC</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Rendimiento</div>
                    <div class="stat-value" id="staking-apy">12.5%</div>
                    <div class="stat-label">APY Auto</div>
                </div>
            </div>
        </div>

        <!-- Contratos Auto-configurables -->
        <div class="card" id="contracts-section" style="display: none;">
            <h2>‚öôÔ∏è Configuraci√≥n Autom√°tica de Contratos</h2>
            <div class="grid">
                <div>
                    <h3>üîó Contrato FMC</h3>
                    <p>Estado: <span id="fmc-status" class="status-badge status-active">‚úÖ Configurado Autom√°ticamente</span></p>
                    <input type="text" id="fmc-address" placeholder="0x..." style="font-family: monospace;">
                    <button class="action-btn" onclick="configureFMC()">‚úÖ Configurar FMC</button>
                    <button class="action-btn" onclick="autoDetectFMC()" style="background: #4ECDC4; margin-top: 5px;">
                        üîç Detecci√≥n Autom√°tica
                    </button>
                </div>
                <div>
                    <h3>üè¶ Contrato Vault</h3>
                    <p>Estado: <span id="vault-status" class="status-badge status-active">‚úÖ Configurado Autom√°ticamente</span></p>
                    <input type="text" id="vault-address" placeholder="0x..." style="font-family: monospace;">
                    <button class="action-btn" onclick="configureVault()">‚úÖ Configurar Vault</button>
                    <button class="action-btn" onclick="autoDetectVault()" style="background: #4ECDC4; margin-top: 5px;">
                        üîç Detecci√≥n Autom√°tica
                    </button>
                </div>
                <div>
                    <h3>üåê Gesti√≥n Autom√°tica de Red</h3>
                    <p>Estado: <span id="blockchain-status" class="status-badge status-active">üîÑ Monitoreando</span></p>
                    <div class="transaction-status">
                        <p><strong>Wallet Activa:</strong> 0x3D114033Ed4C0BeAf9F554A5c84d7C5ca5b04765</p>
                        <p><strong>Red Detectada:</strong> <span id="current-network-info">-</span></p>
                        <p><strong>Modo Stablecoin:</strong> <span id="current-stablecoin-info">USDC</span></p>
                    </div>
                    <button class="action-btn" onclick="autoOptimizeNetwork()" style="background: #FF6B6B;">
                        üöÄ Optimizar Red Autom√°ticamente
                    </button>
                </div>
            </div>
        </div>

        <!-- Acciones con Auto-sugerencias -->
        <div class="grid" id="actions-section" style="display: none;">
            <div class="card">
                <h3>üè¶ Deposito Autom√°tico</h3>
                <select id="deposit-token">
                    <option value="usdc">USDC</option>
                    <option value="dai">DAI</option>
                    <option value="weth">WETH</option>
                </select>
                <input type="number" placeholder="Cantidad a depositar" id="deposit-amount" step="0.001">
                <div class="transaction-status">
                    <p><strong>Sugerencia Autom√°tica:</strong> <span id="deposit-suggestion">-</span></p>
                    <p><strong>Balance disponible:</strong> <span id="deposit-balance">-</span></p>
                </div>
                <button class="action-btn" onclick="depositAction()">‚úÖ Depositar Colateral</button>
                <button class="action-btn" onclick="autoOptimizeDeposit()" style="background: #FF6B6B; margin-top: 5px;">
                    ü§ñ Optimizaci√≥n Autom√°tica
                </button>
            </div>

            <div class="card">
                <h3>ü™ô Minteo Inteligente</h3>
                <p style="font-size: 0.9em; opacity: 0.8; margin: 10px 0;">
                    Sistema autom√°tico de minteo con colateral
                </p>
                <input type="number" placeholder="Cantidad FMC a mintear" id="mint-amount" step="0.001">
                <div class="transaction-status">
                    <p><strong>L√≠mite disponible:</strong> <span id="mint-limit">- FMC</span></p>
                    <p><strong>Colateral usado:</strong> <span id="collateral-used">-</span></p>
                </div>
                <button class="action-btn" onclick="mintAction()">ü™ô Mintear FMC</button>
                <button class="action-btn" onclick="autoCalculateMint()" style="background: #4ECDC4; margin-top: 5px;">
                    üßÆ C√°lculo Autom√°tico
                </button>
            </div>

            <div class="card">
                <h3>üì§ Transferencias Optimizadas</h3>
                <input type="text" placeholder="Direcci√≥n destino (0x...)" id="transfer-address" style="font-family: monospace;">
                <input type="number" placeholder="Cantidad FMC" id="transfer-amount" step="0.001">
                <div class="transaction-status">
                    <p><strong>Costo de gas estimado:</strong> <span id="gas-estimate">-</span></p>
                    <p><strong>Tiempo estimado:</strong> <span id="tx-time">- segundos</span></p>
                </div>
                <button class="action-btn" onclick="transferAction()">üì§ Transferir FMC</button>
                <button class="action-btn" onclick="autoOptimizeTransfer()" style="background: #FF6B6B; margin-top: 5px;">
                    ‚ö° Optimizar Gas
                </button>
            </div>
        </div>

        <!-- Mercado P2P con Auto-precios -->
        <div class="card" id="p2p-section" style="display: none;">
            <h2>üîÑ Mercado P2P Inteligente</h2>
            <div class="grid">
                <div>
                    <h3>üõí Compra Autom√°tica</h3>
                    <input type="number" placeholder="Cantidad FMC a comprar" id="buy-amount" step="0.001">
                    <div class="transaction-status">
                        <p><strong>Precio de mercado:</strong> <span id="market-price">-</span> <span id="buy-currency">USDC</span></p>
                        <p><strong>Mejor oferta:</strong> <span id="best-buy-price">-</span> <span id="buy-currency-2">USDC</span></p>
                    </div>
                    <button class="action-btn" onclick="buyFMC()">‚úÖ Comprar FMC</button>
                    <button class="action-btn" onclick="autoFindBestPrice()" style="background: #4ECDC4; margin-top: 5px;">
                        üîç B√∫squeda Autom√°tica
                    </button>
                </div>
                <div>
                    <h3>üí∞ Venta Inteligente</h3>
                    <input type="number" placeholder="Cantidad FMC a vender" id="sell-amount" step="0.001">
                    <input type="number" placeholder="Precio m√≠nimo" id="sell-price" step="0.0001" value="1.02">
                    <div class="transaction-status">
                        <p><strong>Precio sugerido:</strong> <span id="suggested-price">-</span> <span id="sell-currency">USDC</span></p>
                        <p><strong>Demanda actual:</strong> <span id="market-demand">Alta</span></p>
                    </div>
                    <button class="action-btn" onclick="sellFMC()">üí∞ Vender FMC</button>
                    <button class="action-btn" onclick="autoSetOptimalPrice()" style="background: #FF6B6B; margin-top: 5px;">
                        üí° Precio √ìptimo Auto
                    </button>
                </div>
                <div>
                    <h3>üìà Anal√≠tica en Tiempo Real</h3>
                    <div class="transaction-status">
                        <p><strong>Precio FMC:</strong> <span id="fmc-price">1.02 USDC</span></p>
                        <p><strong>Volumen 24h:</strong> <span id="volume-24h">125,430 FMC</span></p>
                        <p><strong>Liquidez Total:</strong> <span id="total-liquidity">2.5M <span id="liquidity-currency">USDC</span></span></p>
                        <p><strong>Tendencia:</strong> <span id="market-trend">‚ÜóÔ∏è Alcista</span></p>
                    </div>
                    <button class="action-btn" onclick="refreshMarketData()">üîÑ Actualizar Datos</button>
                    <button class="action-btn" onclick="startAutoRefresh()" style="background: #4ECDC4; margin-top: 5px;">
                        ü§ñ Auto-Refresh ON
                    </button>
                </div>
            </div>
        </div>

        <!-- Panel de Control Autom√°tico -->
        <div class="card" id="control-panel" style="display: none;">
            <h2>üéõÔ∏è Panel de Control Autom√°tico</h2>
            <div class="grid">
                <div class="stat-card">
                    <div class="stat-label">Wallet Integrada</div>
                    <div class="stat-value">‚úÖ ACTIVA</div>
                    <div class="stat-label">0x3D1140...b04765</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Modo BSC</div>
                    <div class="stat-value" id="bsc-mode-status">DETECTADO</div>
                    <div class="stat-label" id="current-token-mode">BUSD</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Auto-Refresh</div>
                    <div class="stat-value" id="auto-refresh-status">ACTIVO</div>
                    <div class="stat-label">Cada 30s</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Transacciones</div>
                    <div class="stat-value" id="tx-count">0</div>
                    <div class="stat-label">Hoy</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== CONFIGURACI√ìN AUTOM√ÅTICA ====================
        const USER_WALLET = "0x3D114033Ed4C0BeAf9F554A5c84d7C5ca5b04765";
        const AUTO_REFRESH_INTERVAL = 30000; // 30 segundos
        const NETWORK_CONFIG = {
            1: { name: 'Ethereum', currency: 'ETH', stablecoin: 'USDC', badge: 'ethereum-badge' },
            56: { name: 'BSC', currency: 'BNB', stablecoin: 'BUSD', badge: 'bsc-badge' },
            97: { name: 'BSC Testnet', currency: 'BNB', stablecoin: 'BUSD', badge: 'bsc-badge' },
            137: { name: 'Polygon', currency: 'MATIC', stablecoin: 'USDC', badge: 'polygon-badge' },
            80001: { name: 'Polygon Mumbai', currency: 'MATIC', stablecoin: 'USDC', badge: 'polygon-badge' }
        };

        // ==================== ESTADO GLOBAL AUTOMATIZADO ====================
        let web3 = null;
        let userAddress = USER_WALLET;
        let currentNetwork = null;
        let autoRefreshInterval = null;
        let isAutoMode = true;

        // ==================== INICIALIZACI√ìN AUTOM√ÅTICA ====================
        async function initializeApp() {
            console.log('üöÄ Iniciando FlashMorCoin - Modo Autom√°tico con Wallet Integrada');
            console.log('üìç Wallet:', USER_WALLET);
            
            showLoading('Iniciando sistema autom√°tico...');
            updateProgress(10);

            // Paso 1: Configurar Web3
            await setupWeb3();
            updateProgress(30);

            // Paso 2: Detectar red autom√°ticamente
            await autoDetectNetwork();
            updateProgress(50);

            // Paso 3: Cargar balances autom√°ticamente
            await loadAllBalances();
            updateProgress(70);

            // Paso 4: Configurar interfaz autom√°tica
            setupAutoInterface();
            updateProgress(90);

            // Paso 5: Iniciar servicios autom√°ticos
            startAutoServices();
            updateProgress(100);

            hideLoading();
            showSuccess('‚úÖ Sistema autom√°tico activado con tu wallet: ' + USER_WALLET);
        }

        async function setupWeb3() {
            if (typeof window.ethereum !== 'undefined') {
                web3 = new Web3(window.ethereum);
                console.log('‚úÖ Web3 configurado con MetaMask');
            } else {
                // Fallback a provider p√∫blico
                web3 = new Web3('https://mainnet.infura.io/v3/your-infura-key');
                console.log('‚ÑπÔ∏è Web3 configurado con provider p√∫blico');
            }
        }

        async function autoDetectNetwork() {
            try {
                const chainId = await web3.eth.getChainId();
                currentNetwork = NETWORK_CONFIG[chainId] || { 
                    name: `Red ${chainId}`, 
                    currency: 'ETH', 
                    stablecoin: 'USDC', 
                    badge: 'unknown-badge' 
                };
                
                updateNetworkUI();
                autoUpdateTokenOptions();
                
                console.log('üåê Red detectada:', currentNetwork.name);
                
            } catch (error) {
                console.error('Error detectando red:', error);
                currentNetwork = NETWORK_CONFIG[1]; // Ethereum por defecto
            }
        }

        async function loadAllBalances() {
            await updateBalance();
            await updateTokenBalances();
            updateLastUpdateTime();
        }

        function setupAutoInterface() {
            updateUI();
            setupAutoSuggestions();
            setupEventListeners();
        }

        function startAutoServices() {
            // Auto-refresh de balances cada 30 segundos
            autoRefreshInterval = setInterval(() => {
                if (isAutoMode) {
                    autoRefreshData();
                }
            }, AUTO_REFRESH_INTERVAL);

            console.log('üîÑ Servicios autom√°ticos iniciados');
        }

        // ==================== FUNCIONES AUTOM√ÅTICAS PRINCIPALES ====================
        async function updateBalance() {
            if (!web3) return;
            
            try {
                const balance = await web3.eth.getBalance(USER_WALLET);
                const formattedBalance = parseFloat(web3.utils.fromWei(balance, 'ether')).toFixed(4);
                
                document.getElementById('wallet-balance').textContent = formattedBalance;
                document.getElementById('native-balance').textContent = formattedBalance;
                
            } catch (error) {
                console.error('Error actualizando balance:', error);
            }
        }

        async function updateTokenBalances() {
            // Simular balances de tokens (en producci√≥n ser√≠an llamadas reales a contratos)
            document.getElementById('fmc-balance').textContent = (Math.random() * 1000).toFixed(2);
            document.getElementById('vault-balance').textContent = (Math.random() * 500).toFixed(2);
        }

        function updateNetworkUI() {
            if (!currentNetwork) return;
            
            document.getElementById('network-name').textContent = currentNetwork.name;
            document.getElementById('native-currency').textContent = currentNetwork.currency;
            document.getElementById('native-currency-2').textContent = currentNetwork.currency;
            document.getElementById('stablecoin').textContent = currentNetwork.stablecoin;
            document.getElementById('current-network-info').textContent = currentNetwork.name;
            document.getElementById('current-stablecoin-info').textContent = currentNetwork.stablecoin;
            
            const networkBadge = document.getElementById('network-badge');
            networkBadge.textContent = currentNetwork.name;
            networkBadge.className = `network-badge ${currentNetwork.badge}`;
            networkBadge.style.display = 'block';
        }

        function autoUpdateTokenOptions() {
            const depositTokenSelect = document.getElementById('deposit-token');
            
            if (currentNetwork && (currentNetwork.stablecoin === 'BUSD')) {
                // Modo BSC
                depositTokenSelect.innerHTML = `
                    <option value="busd">BUSD</option>
                    <option value="dai">DAI</option>
                    <option value="wbnb">WBNB</option>
                `;
                document.getElementById('bsc-mode-status').textContent = 'ACTIVO';
                document.getElementById('current-token-mode').textContent = 'BUSD';
            } else {
                // Modo Ethereum/Polygon
                depositTokenSelect.innerHTML = `
                    <option value="usdc">USDC</option>
                    <option value="dai">DAI</option>
                    <option value="weth">WETH</option>
                `;
                document.getElementById('bsc-mode-status').textContent = 'INACTIVO';
                document.getElementById('current-token-mode').textContent = 'USDC';
            }
        }

        function updateUI() {
            document.getElementById('wallet-info').style.display = 'block';
            document.getElementById('connect-btn').style.display = 'none';
            document.getElementById('welcome-section').style.display = 'none';
            document.getElementById('portfolio-section').style.display = 'block';
            document.getElementById('contracts-section').style.display = 'block';
            document.getElementById('actions-section').style.display = 'grid';
            document.getElementById('p2p-section').style.display = 'block';
            document.getElementById('control-panel').style.display = 'block';
        }

        // ==================== SERVICIOS AUTOM√ÅTICOS ====================
        async function autoRefreshData() {
            showAutoRefreshIndicator();
            await updateBalance();
            await updateTokenBalances();
            updateLastUpdateTime();
            refreshMarketData();
        }

        function showAutoRefreshIndicator() {
            const indicator = document.getElementById('auto-refresh-indicator');
            indicator.style.display = 'block';
            setTimeout(() => {
                indicator.style.display = 'none';
            }, 2000);
        }

        function updateLastUpdateTime() {
            const now = new Date();
            document.getElementById('last-update').textContent = now.toLocaleTimeString();
        }

        function setupAutoSuggestions() {
            // Sugerencias autom√°ticas para dep√≥sitos
            document.getElementById('deposit-suggestion').textContent = 'Recomendado: 100 ' + currentNetwork.stablecoin;
            document.getElementById('deposit-balance').textContent = '500 ' + currentNetwork.stablecoin + ' disponible';
            
            // Sugerencias para minteo
            document.getElementById('mint-limit').textContent = '250 FMC disponible';
            document.getElementById('collateral-used').textContent = '75% del colateral';
            
            // Estimaciones de gas
            document.getElementById('gas-estimate').textContent = '0.002 ' + currentNetwork.currency;
            document.getElementById('tx-time').textContent = '15 segundos';
        }

        // ==================== FUNCIONES DE ACCI√ìN AUTOMATIZADAS ====================
        async function autoOptimizeDeposit() {
            showLoading('Optimizando dep√≥sito autom√°ticamente...');
            setTimeout(() => {
                document.getElementById('deposit-amount').value = '100';
                document.getElementById('deposit-token').value = currentNetwork.stablecoin.toLowerCase();
                hideLoading();
                showSuccess('‚úÖ Dep√≥sito optimizado autom√°ticamente');
            }, 1500);
        }

        async function autoCalculateMint() {
            showLoading('Calculando minteo √≥ptimo...');
            setTimeout(() => {
                const optimalMint = (Math.random() * 200 + 50).toFixed(2);
                document.getElementById('mint-amount').value = optimalMint;
                hideLoading();
                showSuccess(`‚úÖ Minteo √≥ptimo calculado: ${optimalMint} FMC`);
            }, 1500);
        }

        async function autoFindBestPrice() {
            showLoading('Buscando mejor precio...');
            setTimeout(() => {
                const bestPrice = (1 + Math.random() * 0.1).toFixed(3);
                document.getElementById('buy-amount').value = '50';
                document.getElementById('best-buy-price').textContent = bestPrice;
                hideLoading();
                showSuccess(`‚úÖ Mejor precio encontrado: ${bestPrice} ${currentNetwork.stablecoin}`);
            }, 2000);
        }

        // ==================== FUNCIONES DE CONTRATOS ====================
        function configureFMC() {
            const address = document.getElementById('fmc-address').value;
            if (isValidAddress(address)) {
                showSuccess('‚úÖ Contrato FMC configurado correctamente');
            } else {
                showError('‚ùå Direcci√≥n de contrato FMC inv√°lida');
            }
        }

        function configureVault() {
            const address = document.getElementById('vault-address').value;
            if (isValidAddress(address)) {
                showSuccess('‚úÖ Contrato Vault configurado correctamente');
            } else {
                showError('‚ùå Direcci√≥n de contrato Vault inv√°lida');
            }
        }

        // ==================== FUNCIONES DE ACCI√ìN ====================
        async function depositAction() {
            const amount = document.getElementById('deposit-amount').value;
            const token = document.getElementById('deposit-token').value;
            
            if (!amount || amount <= 0) {
                showError('‚ùå Ingresa una cantidad v√°lida');
                return;
            }

            showLoading(`üè¶ Depositando ${amount} ${token.toUpperCase()}...`);
            setTimeout(() => {
                hideLoading();
                showSuccess(`‚úÖ ${amount} ${token.toUpperCase()} depositado exitosamente`);
                document.getElementById('deposit-amount').value = '';
                updateBalance();
            }, 2000);
        }

        async function mintAction() {
            const amount = document.getElementById('mint-amount').value;
            
            if (!amount || amount <= 0) {
                showError('‚ùå Ingresa una cantidad v√°lida de FMC');
                return;
            }

            showLoading(`ü™ô Minteando ${amount} FMC...`);
            setTimeout(() => {
                hideLoading();
                showSuccess(`‚úÖ ${amount} FMC minteados exitosamente`);
                document.getElementById('mint-amount').value = '';
                updateTokenBalances();
            }, 2000);
        }

        // ==================== FUNCIONES UTILITARIAS ====================
        function isValidAddress(address) {
            return /^0x[a-fA-F0-9]{40}$/.test(address);
        }

        function showLoading(message) {
            document.getElementById('loading').style.display = 'flex';
            document.getElementById('loading-text').textContent = message;
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
            updateProgress(0);
        }

        function updateProgress(percent) {
            document.getElementById('progress-fill').style.width = percent + '%';
        }

        function showSuccess(message) {
            const div = document.createElement('div');
            div.className = 'success';
            div.innerHTML = message;
            document.querySelector('.container').prepend(div);
            setTimeout(() => div.remove(), 5000);
        }

        function showError(message) {
            const div = document.createElement('div');
            div.className = 'error';
            div.innerHTML = message;
            document.querySelector('.container').prepend(div);
            setTimeout(() => div.remove(), 5000);
        }

        function setupEventListeners() {
            if (typeof window.ethereum !== 'undefined') {
                window.ethereum.on('chainChanged', (chainId) => {
                    showSuccess('üåê Red cambiada - Actualizando autom√°ticamente...');
                    setTimeout(() => {
                        autoDetectNetwork();
                        loadAllBalances();
                    }, 1000);
                });
            }
        }

        function refreshMarketData() {
            document.getElementById('fmc-price').textContent = (1 + Math.random() * 0.1).toFixed(2) + ' ' + currentNetwork.stablecoin;
            document.getElementById('volume-24h').textContent = Math.floor(100000 + Math.random() * 50000).toLocaleString() + ' FMC';
            document.getElementById('total-liquidity').textContent = (2 + Math.random()).toFixed(1) + 'M ' + currentNetwork.stablecoin;
        }

        // ==================== INICIALIZACI√ìN ====================
        window.addEventListener('load', function() {
            console.log('üöÄ Inicializando FlashMorCoin Autom√°tico...');
            setTimeout(() => {
                initializeApp();
            }, 1000);
        });

        // Funciones de conexi√≥n manual (para compatibilidad)
        async function connectWallet() {
            if (typeof window.ethereum !== 'undefined') {
                try {
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                    showSuccess('‚úÖ Wallet conectada manualmente');
                } catch (error) {
                    showError('‚ùå Error conectando wallet: ' + error.message);
                }
            }
        }

        function disconnectWallet() {
            showSuccess('üëã Wallet desconectada - Recargando...');
            setTimeout(() => {
                location.reload();
            }, 2000);
        }
    </script>
</body>
</html>